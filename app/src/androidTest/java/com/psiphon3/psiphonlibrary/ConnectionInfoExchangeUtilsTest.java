package com.psiphon3.psiphonlibrary;

import android.content.Intent;
import android.nfc.NdefMessage;
import android.nfc.NdefRecord;
import android.nfc.NfcAdapter;

import org.junit.Test;

import static android.nfc.NdefRecord.createMime;
import static org.junit.Assert.assertArrayEquals;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

public class ConnectionInfoExchangeUtilsTest {

    private final String testPayloadStr = "N20xRzNycGNRZWFuV3lzemp1UVJQblo2UlRZM0NtaHozNzFSZUlnQVNqbk8ya3M3ZWtVM2I2Mm9UWU9LZDdaQnRIb0tkY1ZiN0FRUFJ3dUdIUkpLZm1LalVkTlpBVzM4ZFY0VUx2N2lrNU9LeXN3U25LYXJ5YzFvd2FiSHBsTkJ6SVlHQTlhOTZGMlh5YjRkaTA2OTVVdEl5cmtFM0dKNHBNbE9GQUx2cWlMTDFwVTRUYXBRd3dBRzAydzFzcGJyTkVkNThWSXFobHhISXJWYmo3V09ZOWlPbXpmRXdXZFNEMlhsemRCUnBqWldqZ0JybVQ5bzBEZ0pQNlQ3bEE2UnBqRTlnZHpaVDdORjE1MTV2ZW1GRDJQWjdtdnNMTmxzWnIzWklBZDA2ZmV1OWVZZUJZakhOZ1I3aklEcUdobHlYTE5GcEZEZmZadVQ4bE5hSm1kb0ZRR0JhZ0J2R0FwQ0k0QmFVbjBEZUN5WUxyYUZrbDN1N0xsVDJtRjlYNUw1b3hGQURNbGt0bTY3Z1FBRkZkMTRTaENsdTRVQTNvMkNpZkZQekNSMHFiMG5uaVpya1JUZVNxVmJ1YVZTR1dYdVlCSE5NSW9UbmVCNVc2TDVMYm9XWXB0Y013QTdheko3WTZHOG5Sc2tVSlRkRENpY2tGYlFadnVXajRHRk10R3VQdzZ4SzBFVEh5NXh2akpvR2prUjRmZ2RMMkxwRUhJMTZSZzJDODFyUnp3TW9zYWR5bENUYTZ4VGtWV1ZURjc5U1EwclMzME9FRGRBbWZ2ZHB5ZG10d0RpYm1YU2tXcHJyRXYzNlVRVllNVnhicmtCcUlUUTlhc2c2RUNrZjBySHE0aXloN3ZtOEFxMVVGSHo2ZFI0YzdTU1MyeGw5c0VPdDdybzBMNXlreWRtMHVhcFJFMllCaWphV0ZPN2pFVHVMa2phMkNGdnA2dHRHUUhuR3o4YTlsSFNkRGJOOGp4MHdnV0RRTmlkZ0d2am9USDNjWWptN1VqSWhrMFFMblhISVp2QkNFTUlHczg2NGlMQXRSSjdTOVJMa0g5ZWJoRGp2c0RKaUR2T1R1cXZZcmt2eG9DVGdrSGVkY25pSWtZeUN3Q3h6Y3JGS09tYWpmREN4RDdZMEpaS0ZYZHRvTnRSeUxqWk9jTHM5YjhWWWVvUHBoRWR3R3VhclVNMVZaMGRvZmFHaGE5N2ludE4zeEpqTlNnY05EM21kb2dFZ1o0NlBVdllMTzJuTGRGdU5JeTlnSDJpZGJHSW1INklpS1dYakJMcEVuOU9idFBsaTIyS051OVV4YU5QaDBzV0pjcWVMeVQ1MVZmV2tKaVRDd29tSEJzOWJlZUhrVHl4T2pvNDF5d3poN3hmWVFiYnEzRm9IN253bmozYWFtOU5Gc2FWZHllVXZqTjVGbG1uczhtS0pLOEswTlBKNUgxSzdFM2h1VWpRZjFld3J1SkxLNWY1SVJTSVd4eFhHcXZTSlhwelk4Zm5vbUd3OWZGNGh1aThuTUowRjB4SjNnUnZDOHlzV3ZZS0s3Zmo5MlVteHIyczJpMWF5OTJPVDg3emJpbXJQRFgxWUpjMmVGbzFmQkc4cWloVXJlQ2RnWGduSUM5dXByN0NCeWlmZDhwZmF4bGZ3SDVxNkJsdHpHQWY1ZmFIRGlhM1FBS1lza1J0NjRzMGFRQTJON2thdDg3U3ZLOFJKOUdQNEZjWXh0dWJ3Q1lxWDNCdVBkVDBEeUtZNkNWTE9zaEZ5S0ZqM3ZIQWdHOFY4Tmh6UEtCMndwUlRUQXZwRWdZZDFOZmNrREIyOWZEa2trMzRZclRmc0VRS2JEcXVpZjhBNWZ5UDl4QWpBcmFUR0RXV3BxUjI5RkJVZnpqYUtsemZKUnRHNmI4TGI5ZFhESXE0WVJjSHhHMWgzdjdiS0V2RnpkMjdjYUN1Znd4Vm5kTThKNGMzMlQ4RW5NcVR5Q2taY0gxOGJZU09TNU1TbDRIUFR6eVNLZUIxWmRuMThLZmQ3cnByd29JWEVpWlRBdkV0YjZyRlcyZkVQMjVQRnlXMHlYbkN6ZWpWb1dwemF4ZjR1MkhqUEdFWEhmem1NUml5NzhkcXVpMnpuUGxDU3RUdDZBSTdXZmJ3MExGWHNlSTlIUkVnUWY1aHZPRTBJV3YwRTdxc0xId0prTkFjM0xoRXZ1UUFnbkRzSTZha0pBTFhZRFZJUFExNUJ1RjM0RlF2Rmw4SzRGWHdPNHVhZzF2TDVpdmlDTFU2bGs3c3hreEd2d0tZbEFLR25XbEsxaE1ncHlQOVJCM1lhcktkYzBLcVg3c0RpVXpMSFUyWTZrRWFCZkhFeWxMWU5oY2xLcHBQUmxGUGNzZjBxQmVwdjQ5bmRSYklTNXZBZFlYcGtWa2NjM21sYkFhdWgzZlJUeTMzR2VtWDNIQzl1bThYQTROWE5YOVRWZk14aWhIUXhXS21xVHpDUVdSczEwU1BsaGRCSkVaYUZzS3YyZHJqZ0dQZ2Z3WkM5MDBCQUZ2NUVVenp3VTVOb1pyVkV1Q1NmbndEQ1hyeWwybnlENHAwUnExd2ZTUXRkYkhHaHFNdlRTTVZySVpWRlViQ2ZiYTMyWWR6MlpSRmZsUVlTMkhGR29oaWl1UDlsSmM0OHUxRFgwcUF2cHFsMG5iMlVXcmpyOVo5N2xZT3RjQkFueHhGNEdBVzlMM0IyYUVqYXhiUnh1aFBhWHc4OUVtcGd0ZzlQNWNUZW14djUydEpNeG1tcWRwZTk2aDVvM2FNeGNkZGNwOW9FUEFQczc1Z1prbmVmakRIWkhUaUtERW5RQzJxdmh2OGJlVlZnSWgwQ1B5UWlJNDk1enlzN3lVQ0J2R09rTlZ3U3RXR1d4U2NLNDd5cXMwNkVCdGFRdHFvaU9aYWN5Ujd5MzYyUEhlTWs5cTl6dTVZQlg4bU5NSkJjRkxyeldrTmN2cG4yTDBlOFY4UTNSSWh4M1dTc2JwSTZXV2NBQ1o3NmJ3VVhDOU05aVRHTjh1MDlNc1VzMzVsUGNvYVhadTBKSDYzV0h1MG5aTWZ4MVdiVXdnTTZDNmNsa1p0VHpZOHA1dTlnSmEyYW1QS2o5NDNaTHNnd0l2S1FiNGd4NEJVcFdYcVNPSDFSVDBwUHpGMm9CRFR2WGdxR29leWRXRnBGb0FiR0tDakRLTllUT2tWTVlENU5PU3FHOElIU3M0ZjZmQnRONzNISkJrQ1VZTTlPMFVrSkpHZmV1ZHVaUnFtcVpMbEMzWklQRDF4cTB4aVJINkdhUm9SMmRiOGM4anZFN3JMRkpTZVloMDQ1dUV3NFpOZno4SlFieTBFWVNybE9EUDYwQTlQWWdxcHhBMXVsMmRRenRtU25HYW01SFBoeTlUelRCcjFQTUthVG9uR3YyZUxPN2owcUNkYlFRYllXc0FCNExoeVhjR1U4WkVhU0ZhYXd6RlN3dkN1c3ZBZG93MHMyUEpQejVaSDNiQTgxYzBSdXJSVGRKRkN1Vmp1OTB3c3NTbENKcW1RRVlEUGhVSjM5YnFLam14M2VJSjE5TmhwYlUzd1ROUjdNNG5zdG10QlJwQ0pSZFAyNk9VNWk4dUJHUjdnQlloYzdiZjVEZzl0SmpOakJNR3oxNHpndFM2RlRXbjFnc1FEY0FQTlhCbHZ6Mmk4dkNlMHZCUXBaOVVZc05yMk5Ea1hJd0x4WDJMNTFYbEV5YjhCOG9raU85REhVRDlUSll2aHdwR3RHT0tHUUR0YXN0NjlHWTNPR1RLWnVYRlEwUlpJRDdLRmhvM1NWQXprcjdTSjE3eEpoVWY4Y0xNRFp1RnhjWkJUU1hiY2kyR1dHQm1PZnFNUU1HWmJXR3lNN2k1NWR0RXJQOFBmeFIySFZUdmgzNjgzaXdSQzhSR3RTNXlxM2Y1R3ZJOWtzczIybnVYMlZ5czh3cDViNjhqdTBac1R2WHdpZmRMdnZjZmR1VVhRV2M0ZHp5RFJtU2lrR0Y3anE4NlVDQ2NTCg==";
    private final byte[] testPayloadArr = new byte[]{78,50,48,120,82,122,78,121,99,71,78,82,90,87,70,117,86,51,108,122,101,109,112,49,85,86,74,81,98,108,111,50,85,108,82,90,77,48,78,116,97,72,111,122,78,122,70,83,90,85,108,110,81,86,78,113,98,107,56,121,97,51,77,51,90,87,116,86,77,50,73,50,77,109,57,85,87,85,57,76,90,68,100,97,81,110,82,73,98,48,116,107,89,49,90,105,78,48,70,82,85,70,74,51,100,85,100,73,85,107,112,76,90,109,49,76,97,108,86,107,84,108,112,66,86,122,77,52,90,70,89,48,86,85,120,50,78,50,108,114,78,85,57,76,101,88,78,51,85,50,53,76,89,88,74,53,89,122,70,118,100,50,70,105,83,72,66,115,84,107,74,54,83,86,108,72,81,84,108,104,79,84,90,71,77,108,104,53,89,106,82,107,97,84,65,50,79,84,86,86,100,69,108,53,99,109,116,70,77,48,100,75,78,72,66,78,98,69,57,71,81,85,120,50,99,87,108,77,84,68,70,119,86,84,82,85,89,88,66,82,100,51,100,66,82,122,65,121,100,122,70,122,99,71,74,121,84,107,86,107,78,84,104,87,83,88,70,111,98,72,104,73,83,88,74,87,89,109,111,51,86,48,57,90,79,87,108,80,98,88,112,109,82,88,100,88,90,70,78,69,77,108,104,115,101,109,82,67,85,110,66,113,87,108,100,113,90,48,74,121,98,86,81,53,98,122,66,69,90,48,112,81,78,108,81,51,98,69,69,50,85,110,66,113,82,84,108,110,90,72,112,97,86,68,100,79,82,106,69,49,77,84,86,50,90,87,49,71,82,68,74,81,87,106,100,116,100,110,78,77,84,109,120,122,87,110,73,122,87,107,108,66,90,68,65,50,90,109,86,49,79,87,86,90,90,85,74,90,97,107,104,79,90,49,73,51,97,107,108,69,99,85,100,111,98,72,108,89,84,69,53,71,99,69,90,69,90,109,90,97,100,86,81,52,98,69,53,104,83,109,49,107,98,48,90,82,82,48,74,104,90,48,74,50,82,48,70,119,81,48,107,48,81,109,70,86,98,106,66,69,90,85,78,53,87,85,120,121,89,85,90,114,98,68,78,49,78,48,120,115,86,68,74,116,82,106,108,89,78,85,119,49,98,51,104,71,81,85,82,78,98,71,116,48,98,84,89,51,90,49,70,66,82,107,90,107,77,84,82,84,97,69,78,115,100,84,82,86,81,84,78,118,77,107,78,112,90,107,90,81,101,107,78,83,77,72,70,105,77,71,53,117,97,86,112,121,97,49,74,85,90,86,78,120,86,109,74,49,89,86,90,84,82,49,100,89,100,86,108,67,83,69,53,78,83,87,57,85,98,109,86,67,78,86,99,50,84,68,86,77,89,109,57,88,87,88,66,48,89,48,49,51,81,84,100,104,101,107,111,51,87,84,90,72,79,71,53,83,99,50,116,86,83,108,82,107,82,69,78,112,89,50,116,71,89,108,70,97,100,110,86,88,97,106,82,72,82,107,49,48,82,51,86,81,100,122,90,52,83,122,66,70,86,69,104,53,78,88,104,50,97,107,112,118,82,50,112,114,85,106,82,109,90,50,82,77,77,107,120,119,82,85,104,74,77,84,90,83,90,122,74,68,79,68,70,121,85,110,112,51,84,87,57,122,89,87,82,53,98,69,78,85,89,84,90,52,86,71,116,87,86,49,90,85,82,106,99,53,85,49,69,119,99,108,77,122,77,69,57,70,82,71,82,66,98,87,90,50,90,72,66,53,90,71,49,48,100,48,82,112,89,109,49,89,85,50,116,88,99,72,74,121,82,88,89,122,78,108,86,82,86,108,108,78,86,110,104,105,99,109,116,67,99,85,108,85,85,84,108,104,99,50,99,50,82,85,78,114,90,106,66,121,83,72,69,48,97,88,108,111,78,51,90,116,79,69,70,120,77,86,86,71,83,72,111,50,90,70,73,48,89,122,100,84,85,49,77,121,101,71,119,53,99,48,86,80,100,68,100,121,98,122,66,77,78,88,108,114,101,87,82,116,77,72,86,104,99,70,74,70,77,108,108,67,97,87,112,104,86,48,90,80,78,50,112,70,86,72,86,77,97,50,112,104,77,107,78,71,100,110,65,50,100,72,82,72,85,85,104,117,82,51,111,52,89,84,108,115,83,70,78,107,82,71,74,79,79,71,112,52,77,72,100,110,86,48,82,82,84,109,108,107,90,48,100,50,97,109,57,85,83,68,78,106,87,87,112,116,78,49,86,113,83,87,104,114,77,70,70,77,98,108,104,73,83,86,112,50,81,107,78,70,84,85,108,72,99,122,103,50,78,71,108,77,81,88,82,83,83,106,100,84,79,86,74,77,97,48,103,53,90,87,74,111,82,71,112,50,99,48,82,75,97,85,82,50,84,49,82,49,99,88,90,90,99,109,116,50,101,71,57,68,86,71,100,114,83,71,86,107,89,50,53,112,83,87,116,90,101,85,78,51,81,51,104,54,89,51,74,71,83,48,57,116,89,87,112,109,82,69,78,52,82,68,100,90,77,69,112,97,83,48,90,89,90,72,82,118,84,110,82,83,101,85,120,113,87,107,57,106,84,72,77,53,89,106,104,87,87,87,86,118,85,72,66,111,82,87,82,51,82,51,86,104,99,108,86,78,77,86,90,97,77,71,82,118,90,109,70,72,97,71,69,53,78,50,108,117,100,69,52,122,101,69,112,113,84,108,78,110,89,48,53,69,77,50,49,107,98,50,100,70,90,49,111,48,78,108,66,86,100,108,108,77,84,122,74,117,84,71,82,71,100,85,53,74,101,84,108,110,83,68,74,112,90,71,74,72,83,87,49,73,78,107,108,112,83,49,100,89,97,107,74,77,99,69,86,117,79,85,57,105,100,70,66,115,97,84,73,121,83,48,53,49,79,86,86,52,89,85,53,81,97,68,66,122,86,48,112,106,99,87,86,77,101,86,81,49,77,86,90,109,86,50,116,75,97,86,82,68,100,50,57,116,83,69,74,122,79,87,74,108,90,85,104,114,86,72,108,52,84,50,112,118,78,68,70,53,100,51,112,111,78,51,104,109,87,86,70,105,89,110,69,122,82,109,57,73,78,50,53,51,98,109,111,122,89,87,70,116,79,85,53,71,99,50,70,87,90,72,108,108,86,88,90,113,84,106,86,71,98,71,49,117,99,122,104,116,83,48,112,76,79,69,115,119,84,108,66,75,78,85,103,120,83,122,100,70,77,50,104,49,86,87,112,82,90,106,70,108,100,51,74,49,83,107,120,76,78,87,89,49,83,86,74,84,83,86,100,52,101,70,104,72,99,88,90,84,83,108,104,119,101,108,107,52,90,109,53,118,98,85,100,51,79,87,90,71,78,71,104,49,97,84,104,117,84,85,111,119,82,106,66,52,83,106,78,110,85,110,90,68,79,72,108,122,86,51,90,90,83,48,115,51,90,109,111,53,77,108,86,116,101,72,73,121,99,122,74,112,77,87,70,53,79,84,74,80,86,68,103,51,101,109,74,112,98,88,74,81,82,70,103,120,87,85,112,106,77,109,86,71,98,122,70,109,81,107,99,52,99,87,108,111,86,88,74,108,81,50,82,110,87,71,100,117,83,85,77,53,100,88,66,121,78,48,78,67,101,87,108,109,90,68,104,119,90,109,70,52,98,71,90,51,83,68,86,120,78,107,74,115,100,72,112,72,81,87,89,49,90,109,70,73,82,71,108,104,77,49,70,66,83,49,108,122,97,49,74,48,78,106,82,122,77,71,70,82,81,84,74,79,78,50,116,104,100,68,103,51,85,51,90,76,79,70,74,75,79,85,100,81,78,69,90,106,87,88,104,48,100,87,74,51,81,49,108,120,87,68,78,67,100,86,66,107,86,68,66,69,101,85,116,90,78,107,78,87,84,69,57,122,97,69,90,53,83,48,90,113,77,51,90,73,81,87,100,72,79,70,89,52,84,109,104,54,85,69,116,67,77,110,100,119,85,108,82,85,81,88,90,119,82,87,100,90,90,68,70,79,90,109,78,114,82,69,73,121,79,87,90,69,97,50,116,114,77,122,82,90,99,108,82,109,99,48,86,82,83,50,74,69,99,88,86,112,90,106,104,66,78,87,90,53,85,68,108,52,81,87,112,66,99,109,70,85,82,48,82,88,86,51,66,120,85,106,73,53,82,107,74,86,90,110,112,113,89,85,116,115,101,109,90,75,85,110,82,72,78,109,73,52,84,71,73,53,90,70,104,69,83,88,69,48,87,86,74,106,83,72,104,72,77,87,103,122,100,106,100,105,83,48,86,50,82,110,112,107,77,106,100,106,89,85,78,49,90,110,100,52,86,109,53,107,84,84,104,75,78,71,77,122,77,108,81,52,82,87,53,78,99,86,82,53,81,50,116,97,89,48,103,120,79,71,74,90,85,48,57,84,78,85,49,84,98,68,82,73,85,70,82,54,101,86,78,76,90,85,73,120,87,109,82,117,77,84,104,76,90,109,81,51,99,110,66,121,100,50,57,74,87,69,86,112,87,108,82,66,100,107,86,48,89,106,90,121,82,108,99,121,90,107,86,81,77,106,86,81,82,110,108,88,77,72,108,89,98,107,78,54,90,87,112,87,98,49,100,119,101,109,70,52,90,106,82,49,77,107,104,113,85,69,100,70,87,69,104,109,101,109,49,78,85,109,108,53,78,122,104,107,99,88,86,112,77,110,112,117,85,71,120,68,85,51,82,85,100,68,90,66,83,84,100,88,90,109,74,51,77,69,120,71,87,72,78,108,83,84,108,73,85,107,86,110,85,87,89,49,97,72,90,80,82,84,66,74,86,51,89,119,82,84,100,120,99,48,120,73,100,48,112,114,84,107,70,106,77,48,120,111,82,88,90,49,85,85,70,110,98,107,82,122,83,84,90,104,97,48,112,66,84,70,104,90,82,70,90,74,85,70,69,120,78,85,74,49,82,106,77,48,82,108,70,50,82,109,119,52,83,122,82,71,87,72,100,80,78,72,86,104,90,122,70,50,84,68,86,112,100,109,108,68,84,70,85,50,98,71,115,51,99,51,104,114,101,69,100,50,100,48,116,90,98,69,70,76,82,50,53,88,98,69,115,120,97,69,49,110,99,72,108,81,79,86,74,67,77,49,108,104,99,107,116,107,89,122,66,76,99,86,103,51,99,48,82,112,86,88,112,77,83,70,85,121,87,84,90,114,82,87,70,67,90,107,104,70,101,87,120,77,87,85,53,111,89,50,120,76,99,72,66,81,85,109,120,71,85,71,78,122,90,106,66,120,81,109,86,119,100,106,81,53,98,109,82,83,89,107,108,84,78,88,90,66,90,70,108,89,99,71,116,87,97,50,78,106,77,50,49,115,89,107,70,104,100,87,103,122,90,108,74,85,101,84,77,122,82,50,86,116,87,68,78,73,81,122,108,49,98,84,104,89,81,84,82,79,87,69,53,89,79,86,82,87,90,107,49,52,97,87,104,73,85,88,104,88,83,50,49,120,86,72,112,68,85,86,100,83,99,122,69,119,85,49,66,115,97,71,82,67,83,107,86,97,89,85,90,122,83,51,89,121,90,72,74,113,90,48,100,81,90,50,90,51,87,107,77,53,77,68,66,67,81,85,90,50,78,85,86,86,101,110,112,51,86,84,86,79,98,49,112,121,86,107,86,49,81,49,78,109,98,110,100,69,81,49,104,121,101,87,119,121,98,110,108,69,78,72,65,119,85,110,69,120,100,50,90,84,85,88,82,107,89,107,104,72,97,72,70,78,100,108,82,84,84,86,90,121,83,86,112,87,82,108,86,105,81,50,90,105,89,84,77,121,87,87,82,54,77,108,112,83,82,109,90,115,85,86,108,84,77,107,104,71,82,50,57,111,97,87,108,49,85,68,108,115,83,109,77,48,79,72,85,120,82,70,103,119,99,85,70,50,99,72,70,115,77,71,53,105,77,108,86,88,99,109,112,121,79,86,111,53,78,50,120,90,84,51,82,106,81,107,70,117,101,72,104,71,78,69,100,66,86,122,108,77,77,48,73,121,89,85,86,113,89,88,104,105,85,110,104,49,97,70,66,104,87,72,99,52,79,85,86,116,99,71,100,48,90,122,108,81,78,87,78,85,90,87,49,52,100,106,85,121,100,69,112,78,101,71,49,116,99,87,82,119,90,84,107,50,97,68,86,118,77,50,70,78,101,71,78,107,90,71,78,119,79,87,57,70,85,69,70,81,99,122,99,49,90,49,112,114,98,109,86,109,97,107,82,73,87,107,104,85,97,85,116,69,82,87,53,82,81,122,74,120,100,109,104,50,79,71,74,108,86,108,90,110,83,87,103,119,81,49,66,53,85,87,108,74,78,68,107,49,101,110,108,122,78,51,108,86,81,48,74,50,82,48,57,114,84,108,90,51,85,51,82,88,82,49,100,52,85,50,78,76,78,68,100,53,99,88,77,119,78,107,86,67,100,71,70,82,100,72,70,118,97,85,57,97,89,87,78,53,85,106,100,53,77,122,89,121,85,69,104,108,84,87,115,53,99,84,108,54,100,84,86,90,81,108,103,52,98,85,53,78,83,107,74,106,82,107,120,121,101,108,100,114,84,109,78,50,99,71,52,121,84,68,66,108,79,70,89,52,85,84,78,83,83,87,104,52,77,49,100,84,99,50,74,119,83,84,90,88,86,50,78,66,81,49,111,51,78,109,74,51,86,86,104,68,79,85,48,53,97,86,82,72,84,106,104,49,77,68,108,78,99,49,86,122,77,122,86,115,85,71,78,118,89,86,104,97,100,84,66,75,83,68,89,122,86,48,104,49,77,71,53,97,84,87,90,52,77,86,100,105,86,88,100,110,84,84,90,68,78,109,78,115,97,49,112,48,86,72,112,90,79,72,65,49,100,84,108,110,83,109,69,121,89,87,49,81,83,50,111,53,78,68,78,97,84,72,78,110,100,48,108,50,83,49,70,105,78,71,100,52,78,69,74,86,99,70,100,89,99,86,78,80,83,68,70,83,86,68,66,119,85,72,112,71,77,109,57,67,82,70,82,50,87,71,100,120,82,50,57,108,101,87,82,88,82,110,66,71,98,48,70,105,82,48,116,68,97,107,82,76,84,108,108,85,84,50,116,87,84,86,108,69,78,85,53,80,85,51,70,72,79,69,108,73,85,51,77,48,90,106,90,109,81,110,82,79,78,122,78,73,83,107,74,114,81,49,86,90,84,84,108,80,77,70,86,114,83,107,112,72,90,109,86,49,90,72,86,97,85,110,70,116,99,86,112,77,98,69,77,122,87,107,108,81,82,68,70,52,99,84,66,52,97,86,74,73,78,107,100,104,85,109,57,83,77,109,82,105,79,71,77,52,97,110,90,70,78,51,74,77,82,107,112,84,90,86,108,111,77,68,81,49,100,85,86,51,78,70,112,79,90,110,111,52,83,108,70,105,101,84,66,70,87,86,78,121,98,69,57,69,85,68,89,119,81,84,108,81,87,87,100,120,99,72,104,66,77,88,86,115,77,109,82,82,101,110,82,116,85,50,53,72,89,87,48,49,83,70,66,111,101,84,108,85,101,108,82,67,99,106,70,81,84,85,116,104,86,71,57,117,82,51,89,121,90,85,120,80,78,50,111,119,99,85,78,107,89,108,70,82,89,108,108,88,99,48,70,67,78,69,120,111,101,86,104,106,82,49,85,52,87,107,86,104,85,48,90,104,89,88,100,54,82,108,78,51,100,107,78,49,99,51,90,66,90,71,57,51,77,72,77,121,85,69,112,81,101,106,86,97,83,68,78,105,81,84,103,120,89,122,66,83,100,88,74,83,86,71,82,75,82,107,78,49,86,109,112,49,79,84,66,51,99,51,78,84,98,69,78,75,99,87,49,82,82,86,108,69,85,71,104,86,83,106,77,53,89,110,70,76,97,109,49,52,77,50,86,74,83,106,69,53,84,109,104,119,89,108,85,122,100,49,82,79,85,106,100,78,78,71,53,122,100,71,49,48,81,108,74,119,81,48,112,83,90,70,65,121,78,107,57,86,78,87,107,52,100,85,74,72,85,106,100,110,81,108,108,111,89,122,100,105,90,106,86,69,90,122,108,48,83,109,112,79,97,107,74,78,82,51,111,120,78,72,112,110,100,70,77,50,82,108,82,88,98,106,70,110,99,49,70,69,89,48,70,81,84,108,104,67,98,72,90,54,77,109,107,52,100,107,78,108,77,72,90,67,85,88,66,97,79,86,86,90,99,48,53,121,77,107,53,69,97,49,104,74,100,48,120,52,87,68,74,77,78,84,70,89,98,69,86,53,89,106,104,67,79,71,57,114,97,85,56,53,82,69,104,86,82,68,108,85,83,108,108,50,97,72,100,119,82,51,82,72,84,48,116,72,85,85,82,48,89,88,78,48,78,106,108,72,87,84,78,80,82,49,82,76,87,110,86,89,82,108,69,119,85,108,112,74,82,68,100,76,82,109,104,118,77,49,78,87,81,88,112,114,99,106,100,84,83,106,69,51,101,69,112,111,86,87,89,52,89,48,120,78,82,70,112,49,82,110,104,106,87,107,74,85,85,49,104,105,89,50,107,121,82,49,100,72,81,109,49,80,90,110,70,78,85,85,49,72,87,109,74,88,82,51,108,78,78,50,107,49,78,87,82,48,82,88,74,81,79,70,66,109,101,70,73,121,83,70,90,85,100,109,103,122,78,106,103,122,97,88,100,83,81,122,104,83,82,51,82,84,78,88,108,120,77,50,89,49,82,51,90,74,79,87,116,122,99,122,73,121,98,110,86,89,77,108,90,53,99,122,104,51,99,68,86,105,78,106,104,113,100,84,66,97,99,49,82,50,87,72,100,112,90,109,82,77,100,110,90,106,90,109,82,49,86,86,104,82,86,50,77,48,90,72,112,53,82,70,74,116,85,50,108,114,82,48,89,51,97,110,69,52,78,108,86,68,81,50,78,84,67,103,61,61};

    @Test
    public void isNfcDiscoveredIntent() {
        Intent intent = new Intent();

        // Test with random action
        intent.setAction("NfcAdapter.ACTION_TECH_DISCOVERED");
        assertFalse(ConnectionInfoExchangeUtils.isNfcDiscoveredIntent(intent));

        // Test with NFC action w/out payload
        intent.setAction(NfcAdapter.ACTION_TECH_DISCOVERED);
        assertFalse(ConnectionInfoExchangeUtils.isNfcDiscoveredIntent(intent));

        // Test with correct action
        intent.setAction(NfcAdapter.ACTION_NDEF_DISCOVERED);
        assertTrue(ConnectionInfoExchangeUtils.isNfcDiscoveredIntent(intent));
    }

    @Test
    public void encodeConnectionInfo() {
        assertEquals(testPayloadStr, ConnectionInfoExchangeUtils.encodeConnectionInfo(testPayloadArr));
        assertEquals("", ConnectionInfoExchangeUtils.encodeConnectionInfo(new byte[] {}));
    }

    @Test
    public void decodeConnectionInfo() {
        assertArrayEquals(testPayloadArr, ConnectionInfoExchangeUtils.decodeConnectionInfo(testPayloadStr));
        assertArrayEquals(new byte[] {}, ConnectionInfoExchangeUtils.decodeConnectionInfo(""));
    }

    @Test
    public void getConnectionInfoPayloadFromNfcIntent() {
        Intent intent = new Intent();
        NdefMessage[] ndefMessages = NdefMessage.CREATOR.newArray(1);
        ndefMessages[0] = new NdefMessage(
                new NdefRecord[] { createMime(
                        ConnectionInfoExchangeUtils.NFC_MIME_TYPE, testPayloadArr)
                });
        intent.putExtra(NfcAdapter.EXTRA_NDEF_MESSAGES, ndefMessages);
        assertEquals(testPayloadStr, ConnectionInfoExchangeUtils.getConnectionInfoPayloadFromNfcIntent(intent));
    }
}